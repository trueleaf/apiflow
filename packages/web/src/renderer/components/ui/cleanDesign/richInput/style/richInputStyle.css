/* ClRichInput 组件样式 - 极简无边框设计 */

/* CSS 变量定义 */
:root {
  --cl-rich-input-bg: var(--el-fill-color-blank);
  --cl-rich-input-text: #333;
  --cl-rich-input-placeholder: #999;
  --cl-rich-input-disabled-text: var(--el-disabled-text-color);
  --cl-rich-input-disabled-bg: var(--el-disabled-bg-color);
  --cl-rich-input-min-height: 32px;
  --cl-rich-input-padding: 6px 0;
  --cl-rich-input-font-size: 14px;
  --cl-rich-input-line-height: 1.5;
  --cl-rich-input-pinned-z-index: 1000;
  --cl-rich-input-popover-bg: var(--el-color-white);
  --cl-rich-input-popover-border: var(--el-border-color-light);
  --cl-rich-input-popover-shadow: 0 8px 24px rgba(15, 23, 42, 0.1);
  --cl-rich-input-popover-radius: 8px;
  --cl-rich-input-popover-z-index: 2200;
  --cl-rich-input-popover-top: 0px;
  --cl-rich-input-popover-left: 0px;
}

/* 暗色主题变量 */
[data-theme="dark"] {
  --cl-rich-input-bg: var(--el-fill-color-blank);
  --cl-rich-input-text: #e5e5e5;
  --cl-rich-input-placeholder: #666;
  --cl-rich-input-popover-bg: #1f1f1f;
  --cl-rich-input-popover-border: var(--bg-white-08);
  --cl-rich-input-popover-shadow: 0 8px 24px var(--bg-black-40);
}

/* 主容器 */
.cl-rich-input {
  position: relative;
  width: 100%;
  background: var(--cl-rich-input-bg);
  font-size: var(--cl-rich-input-font-size);
  line-height: var(--cl-rich-input-line-height);
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
}

/* 编辑器容器 */
.cl-rich-input__editor {
  min-height: var(--cl-rich-input-min-height);
  padding: var(--cl-rich-input-padding);
  color: var(--cl-rich-input-text);
  background: var(--cl-rich-input-bg);
  overflow-y: auto;
  word-wrap: break-word;
  word-break: break-word;
  cursor: text;
}

/* Tiptap 编辑器内容 */
.cl-rich-input__editor .ProseMirror {
  outline: none;
  min-height: inherit;
  color: inherit;
  cursor: text;
  font-size: 12px;
}

/* 段落样式 */
.cl-rich-input__editor .ProseMirror p {
  margin: 0;
  padding: 0;
  color: inherit;
}

.cl-rich-input__editor .ProseMirror p + p {
  margin-top: 0;
}

.cl-rich-input__editor .cl-rich-input__variable {
  color: var(--orange);
  transition: text-decoration 0.2s ease;
  cursor: pointer;
}

.cl-rich-input__editor .cl-rich-input__variable:hover {
  text-decoration: underline;
}

.cl-rich-input__variable-popover {
  position: fixed;
  z-index: var(--cl-rich-input-popover-z-index);
  background: var(--cl-rich-input-popover-bg);
  border: 1px solid var(--cl-rich-input-popover-border);
  border-radius: var(--cl-rich-input-popover-radius);
  box-shadow: var(--cl-rich-input-popover-shadow);
  padding: 12px;
  min-width: 220px;
  max-width: 320px;
  color: var(--cl-rich-input-text);
  outline: none;
  transform: translate3d(-50%, 0, 0);
  top: var(--cl-rich-input-popover-top);
  left: var(--cl-rich-input-popover-left);
}

.cl-rich-input__variable-popover::before,
.cl-rich-input__variable-popover::after {
  content: '';
  position: absolute;
  width: 10px;
  height: 10px;
  transform: rotate(45deg);
  left: 50%;
  margin-left: -5px;
  transition: background 0.2s ease;
}

.cl-rich-input__variable-popover::before {
  background: var(--cl-rich-input-popover-border);
  z-index: -2;
}

.cl-rich-input__variable-popover::after {
  background: var(--cl-rich-input-popover-bg);
  z-index: -1;
}

.cl-rich-input__variable-popover.is-bottom::before,
.cl-rich-input__variable-popover.is-bottom::after {
  top: -5px;
  bottom: auto;
}

.cl-rich-input__variable-popover.is-top::before,
.cl-rich-input__variable-popover.is-top::after {
  bottom: -5px;
  top: auto;
}

.cl-rich-input__variable-popover__content {
  font-size: 13px;
  line-height: 1.6;
  color: inherit;
}

.cl-rich-input-variable-popover-enter-active,
.cl-rich-input-variable-popover-leave-active {
  transition: opacity 0.12s ease, transform 0.12s ease;
}

.cl-rich-input-variable-popover-enter-from,
.cl-rich-input-variable-popover-leave-to {
  opacity: 0;
  transform: translate3d(-50%, -4px, 0);
}

.cl-rich-input-variable-popover-enter-from.is-top,
.cl-rich-input-variable-popover-leave-to.is-top {
  transform: translate3d(-50%, 4px, 0);
}

/* 占位符样式 */
.cl-rich-input__editor .ProseMirror p.is-editor-empty:first-child::before {
  content: attr(data-placeholder);
  color: var(--cl-rich-input-placeholder);
  pointer-events: none;
  position: absolute;
  left: 0;
  right: 0;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.cl-rich-input__editor .ProseMirror p.is-editor-empty:first-child {
  position: relative;
}

/* 禁用状态 */
.cl-rich-input.is-disabled {
  cursor: not-allowed;
  background: var(--cl-rich-input-disabled-bg);
}

.cl-rich-input.is-disabled .cl-rich-input__editor {
  color: var(--cl-rich-input-disabled-text);
  background: var(--cl-rich-input-disabled-bg);
  pointer-events: none;
}

/* 只读状态 */
.cl-rich-input.is-readonly {
  cursor: default;
}

.cl-rich-input.is-readonly .cl-rich-input__editor {
  cursor: default;
}

.cl-rich-input.is-readonly .ProseMirror {
  cursor: default;
}

/* 滚动条样式 */
.cl-rich-input__editor::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

.cl-rich-input__editor::-webkit-scrollbar-thumb {
  background: var(--bg-black-20);
  border-radius: 3px;
}

.cl-rich-input__editor::-webkit-scrollbar-thumb:hover {
  background: var(--bg-black-30);
}

[data-theme="dark"] .cl-rich-input__editor::-webkit-scrollbar-thumb {
  background: var(--bg-white-20);
}

[data-theme="dark"] .cl-rich-input__editor::-webkit-scrollbar-thumb:hover {
  background: var(--bg-white-30);
}

/* expandOnFocus 功能：未聚焦时单行显示 */
.cl-rich-input.expand-on-focus:not(.is-focused) .cl-rich-input__editor {
  max-height: var(--cl-rich-input-min-height);
  overflow: hidden;
}

/* 响应式设计 */
@media (max-width: 768px) {
  :root {
    --cl-rich-input-font-size: 14px;
    --cl-rich-input-padding: 6px 0;
  }
}
